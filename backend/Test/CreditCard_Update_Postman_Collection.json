{
  "info": {
    "_postman_id": "e8c3a2c2-4e7f-4b7d-9d34-1c6d4a3d2f11",
    "name": "CreditCard - Update Operation",
    "description": "Tests for PUT /api/CreditCard/{id} (UpdateCreditCard). Set {{base_url}}, {{jwt_token}}, and {{card_id}} before running.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Update - Success (Visa)",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Authorization", "value": "Bearer {{jwt_token}}", "type": "text" },
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"id\": {{card_id}},\n  \"cardNumber\": \"4111111111111111\",\n  \"expirationDate\": \"2027-12-31T00:00:00Z\",\n  \"creditLimit\": 5000.00,\n  \"currentBalance\": 1500.00,\n  \"type\": \"Visa\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/CreditCard/{{card_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "CreditCard", "{{card_id}}"]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status is 200', function () { pm.response.to.have.status(200); });",
              "pm.test('Success is true', function () { pm.expect(pm.response.json().success).to.eql(true); });"
            ]
          }
        }
      ]
    },
    {
      "name": "Update - Success (Mastercard)",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Authorization", "value": "Bearer {{jwt_token}}", "type": "text" },
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"id\": {{card_id}},\n  \"cardNumber\": \"5555555555554444\",\n  \"expirationDate\": \"2027-06-30T00:00:00Z\",\n  \"creditLimit\": 7500.00,\n  \"currentBalance\": 2000.00,\n  \"type\": \"Mastercard\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/CreditCard/{{card_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "CreditCard", "{{card_id}}"]
        }
      }
    },
    {
      "name": "Update - Success (Amex - 16 digits)",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Authorization", "value": "Bearer {{jwt_token}}", "type": "text" },
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"id\": {{card_id}},\n  \"cardNumber\": \"3400000000000000\",\n  \"expirationDate\": \"2028-01-01T00:00:00Z\",\n  \"creditLimit\": 10000.00,\n  \"currentBalance\": 3000.00,\n  \"type\": \"Amex\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/CreditCard/{{card_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "CreditCard", "{{card_id}}"]
        }
      }
    },
    {
      "name": "Update - Fail (ID mismatch URL vs body)",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Authorization", "value": "Bearer {{jwt_token}}", "type": "text" },
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"id\": 99999,\n  \"cardNumber\": \"4111111111111111\",\n  \"expirationDate\": \"2027-12-31T00:00:00Z\",\n  \"creditLimit\": 5000.00,\n  \"currentBalance\": 1500.00,\n  \"type\": \"Visa\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/CreditCard/{{card_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "CreditCard", "{{card_id}}"]
        }
      }
    },
    {
      "name": "Update - Fail (Luhn invalid)",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Authorization", "value": "Bearer {{jwt_token}}", "type": "text" },
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"id\": {{card_id}},\n  \"cardNumber\": \"4111111111111112\",\n  \"expirationDate\": \"2027-12-31T00:00:00Z\",\n  \"creditLimit\": 5000.00,\n  \"currentBalance\": 1500.00,\n  \"type\": \"Visa\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/CreditCard/{{card_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "CreditCard", "{{card_id}}"]
        }
      }
    },
    {
      "name": "Update - Fail (Expired card)",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Authorization", "value": "Bearer {{jwt_token}}", "type": "text" },
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"id\": {{card_id}},\n  \"cardNumber\": \"4111111111111111\",\n  \"expirationDate\": \"2020-12-31T00:00:00Z\",\n  \"creditLimit\": 5000.00,\n  \"currentBalance\": 1500.00,\n  \"type\": \"Visa\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/CreditCard/{{card_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "CreditCard", "{{card_id}}"]
        }
      }
    },
    {
      "name": "Update - Fail (Balance > Limit)",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Authorization", "value": "Bearer {{jwt_token}}", "type": "text" },
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"id\": {{card_id}},\n  \"cardNumber\": \"4111111111111111\",\n  \"expirationDate\": \"2027-12-31T00:00:00Z\",\n  \"creditLimit\": 1000.00,\n  \"currentBalance\": 1500.00,\n  \"type\": \"Visa\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/CreditCard/{{card_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "CreditCard", "{{card_id}}"]
        }
      }
    },
    {
      "name": "Update - Fail (Type/Prefix mismatch)",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Authorization", "value": "Bearer {{jwt_token}}", "type": "text" },
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"id\": {{card_id}},\n  \"cardNumber\": \"4111111111111111\",\n  \"expirationDate\": \"2027-12-31T00:00:00Z\",\n  \"creditLimit\": 5000.00,\n  \"currentBalance\": 1500.00,\n  \"type\": \"Mastercard\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/CreditCard/{{card_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "CreditCard", "{{card_id}}"]
        }
      }
    },
    {
      "name": "Update - Fail (Blacklisted number)",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Authorization", "value": "Bearer {{jwt_token}}", "type": "text" },
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"id\": {{card_id}},\n  \"cardNumber\": \"1111111111111111\",\n  \"expirationDate\": \"2027-12-31T00:00:00Z\",\n  \"creditLimit\": 5000.00,\n  \"currentBalance\": 1500.00,\n  \"type\": \"Visa\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/CreditCard/{{card_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "CreditCard", "{{card_id}}"]
        }
      }
    }
  ],
  "variable": [
    { "key": "base_url", "value": "https://localhost:5001" },
    { "key": "jwt_token", "value": "" },
    { "key": "card_id", "value": "1" }
  ]
}
